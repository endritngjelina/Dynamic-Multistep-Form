<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Career Application Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --microsoft-blue: #0078d4;
            --microsoft-blue-dark: #106ebe;
            --microsoft-gray: #2b2b2b;
            --microsoft-light-gray: #f2f2f2;
            --microsoft-accent: #ffb900;
            --microsoft-success: #107c10;
            --microsoft-danger: #d83b01;
            --microsoft-purple: #5c2d91;
            --light: #f9fafb;
            --dark: #1f2937;
            --gray: #6b7280;
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #e6f2ff 0%, #cce6ff 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><rect fill="rgba(255,255,255,0.05)" width="100" height="100"/></svg>');
            z-index: -1;
        }

        .floating-shape {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            z-index: -1;
            animation: float 15s infinite ease-in-out;
        }

        .shape-1 {
            width: 200px;
            height: 200px;
            top: 10%;
            left: 5%;
            animation-delay: 0s;
        }

        .shape-2 {
            width: 300px;
            height: 300px;
            bottom: 10%;
            right: 5%;
            animation-delay: 3s;
        }

        .shape-3 {
            width: 150px;
            height: 150px;
            top: 40%;
            right: 15%;
            animation-delay: 6s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(20px, -20px) rotate(5deg); }
            50% { transform: translate(0, 20px) rotate(0deg); }
            75% { transform: translate(-20px, -10px) rotate(-5deg); }
        }

        .form-container {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 1000px;
            overflow: hidden;
            position: relative;
            transform: translateY(0);
            transition: var(--transition);
            animation: slideUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid #e1e1e1;
        }

        .form-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .microsoft-header {
            display: flex;
            align-items: center;
            padding: 15px 30px;
            background: white;
            border-bottom: 1px solid #e1e1e1;
        }

        .microsoft-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--microsoft-gray);
        }

        .microsoft-logo i {
            color: var(--microsoft-blue);
        }

        .save-resume-section {
            margin-left: auto;
            display: flex;
            gap: 10px;
        }

        .form-header {
            background: linear-gradient(135deg, var(--microsoft-blue) 0%, var(--microsoft-blue-dark) 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .form-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            z-index: 1;
        }

        .form-header-content {
            position: relative;
            z-index: 2;
        }

        .form-header h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .form-header p {
            font-size: 1.15rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .progress-container {
            background: white;
            padding: 0 30px;
            position: relative;
        }

        .progress-bar {
            height: 6px;
            background: var(--microsoft-light-gray);
            border-radius: 3px;
            margin: 25px 0;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--microsoft-blue), var(--microsoft-purple));
            border-radius: 3px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            width: 25%;
        }

        .steps-indicator {
            display: flex;
            justify-content: space-between;
            margin: 25px 0 35px 0;
            position: relative;
        }

        .step-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
            cursor: pointer;
        }

        .step-indicator:hover .step-circle {
            transform: scale(1.15);
        }

        .step-circle {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--microsoft-light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: var(--transition);
            position: relative;
            z-index: 2;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .step-circle.active {
            background: linear-gradient(135deg, var(--microsoft-blue), var(--microsoft-purple));
            color: white;
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(0, 120, 212, 0.4);
        }

        .step-circle.completed {
            background: var(--microsoft-success);
            color: white;
            box-shadow: 0 6px 15px rgba(16, 124, 16, 0.4);
        }

        .step-circle.completed::after {
            content: 'âœ“';
            position: absolute;
            font-weight: bold;
        }

        .step-label {
            margin-top: 10px;
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--gray);
            transition: var(--transition);
        }

        .step-indicator.active .step-label {
            color: var(--microsoft-blue);
            font-weight: 600;
        }

        .step-indicator.completed .step-label {
            color: var(--microsoft-success);
        }

        .form-content {
            padding: 40px;
        }

        .step {
            display: none;
            animation: fadeInUp 0.6s ease-out;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--microsoft-gray);
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }

        .step-title::after {
            content: "";
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, var(--microsoft-blue), var(--microsoft-purple));
            border-radius: 2px;
        }

        .step-description {
            color: var(--gray);
            margin-bottom: 30px;
            font-size: 1.1rem;
            max-width: 700px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-weight: 600;
            color: var(--microsoft-gray);
            margin-bottom: 8px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
        }

        .form-label i {
            margin-right: 8px;
            color: var(--microsoft-blue);
        }

        .form-input {
            padding: 16px;
            border: 2px solid #e1e1e1;
            border-radius: 6px;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
            font-family: 'Poppins', sans-serif;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--microsoft-blue);
            box-shadow: 0 0 0 4px rgba(0, 120, 212, 0.15);
        }

        .form-input.error {
            border-color: var(--microsoft-danger);
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .error-message {
            color: var(--microsoft-danger);
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .error-message.show {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .form-select {
            padding: 16px;
            border: 2px solid #e1e1e1;
            border-radius: 6px;
            font-size: 1rem;
            background: white;
            transition: var(--transition);
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230078d4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1em;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--microsoft-blue);
            box-shadow: 0 0 0 4px rgba(0, 120, 212, 0.15);
        }

        .form-textarea {
            padding: 16px;
            border: 2px solid #e1e1e1;
            border-radius: 6px;
            font-size: 1rem;
            min-height: 140px;
            resize: vertical;
            font-family: inherit;
            transition: var(--transition);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
        }

        .form-textarea:focus {
            outline: none;
            border-color: var(--microsoft-blue);
            box-shadow: 0 0 0 4px rgba(0, 120, 212, 0.15);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 6px;
            transition: var(--transition);
            background: rgba(242, 242, 242, 0.5);
        }

        .checkbox-item:hover {
            background: rgba(0, 120, 212, 0.05);
        }

        .checkbox-input {
            width: 22px;
            height: 22px;
            accent-color: var(--microsoft-blue);
            cursor: pointer;
        }

        .checkbox-label {
            font-weight: 500;
            color: var(--microsoft-gray);
            cursor: pointer;
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding: 0 40px 30px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Poppins', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--microsoft-blue), var(--microsoft-blue-dark));
            color: white;
            box-shadow: 0 6px 15px rgba(0, 120, 212, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 10px 20px rgba(0, 120, 212, 0.4);
            background: linear-gradient(135deg, var(--microsoft-blue-dark), #0a5a9e);
        }

        .btn-secondary {
            background: white;
            color: var(--microsoft-gray);
            border: 2px solid #e1e1e1;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .btn-secondary:hover {
            background: #f5f5f5;
            border-color: #d1d1d1;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--microsoft-blue);
            color: var(--microsoft-blue);
            font-weight: 600;
        }

        .btn-outline:hover {
            background: rgba(0, 120, 212, 0.05);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.7);
            transform: scale(0);
            animation: ripple 0.6s linear;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        .review-section {
            background: var(--microsoft-light-gray);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }

        .review-section:hover {
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
        }

        .review-section h3 {
            color: var(--microsoft-gray);
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid var(--microsoft-blue);
            padding-bottom: 10px;
        }

        .review-section h3 i {
            color: var(--microsoft-blue);
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e1e1e1;
        }

        .review-item:last-child {
            border-bottom: none;
        }

        .review-label {
            font-weight: 500;
            color: var(--gray);
            width: 40%;
        }

        .review-value {
            color: var(--microsoft-gray);
            font-weight: 600;
            text-align: right;
            width: 60%;
        }

        .edit-icon {
            color: var(--microsoft-blue);
            margin-left: 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .success-message {
            text-align: center;
            padding: 50px 40px;
        }

        .success-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--microsoft-success), #0a6e0a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            color: white;
            font-size: 2.5rem;
            animation: bounceIn 0.8s ease-out;
            box-shadow: 0 12px 25px rgba(16, 124, 16, 0.3);
        }

        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }

        .success-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--microsoft-gray);
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--microsoft-blue), var(--microsoft-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .success-text {
            color: var(--gray);
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }

        .success-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .skill-tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .skill-tag {
            display: inline-flex;
            align-items: center;
            background: rgba(0, 120, 212, 0.1);
            color: var(--microsoft-blue);
            padding: 6px 15px 6px 12px;
            border-radius: 20px;
            font-weight: 500;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .skill-tag .remove-tag {
            margin-left: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--microsoft-blue);
            opacity: 0.7;
        }

        .skill-tag .remove-tag:hover {
            opacity: 1;
        }

        .skills-input-container {
            position: relative;
        }

        .skills-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid #e1e1e1;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 10;
            display: none;
            max-height: 200px;
            overflow-y: auto;
        }

        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .suggestion-item:hover {
            background: rgba(0, 120, 212, 0.05);
        }

        .char-counter {
            text-align: right;
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 5px;
        }

        .password-strength {
            height: 6px;
            background: #e1e1e1;
            border-radius: 3px;
            margin-top: 8px;
            overflow: hidden;
            position: relative;
        }

        .password-strength-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s;
        }

        .strength-0 { width: 20%; background: var(--microsoft-danger); }
        .strength-1 { width: 40%; background: #ff8c00; }
        .strength-2 { width: 60%; background: var(--microsoft-accent); }
        .strength-3 { width: 80%; background: #7fba00; }
        .strength-4 { width: 100%; background: var(--microsoft-success); }

        .strength-label {
            font-size: 0.8rem;
            margin-top: 5px;
            text-align: right;
        }

        .resume-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            animation: modalIn 0.4s ease-out;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-size: 1.8rem;
            color: var(--microsoft-gray);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-body {
            margin-bottom: 25px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .resume-code {
            background: var(--microsoft-light-gray);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 2px;
            color: var(--microsoft-blue);
            margin: 15px 0;
        }

        .resume-instructions {
            background: rgba(16, 110, 190, 0.05);
            border-left: 4px solid var(--microsoft-blue);
            padding: 15px;
            border-radius: 0 6px 6px 0;
            margin: 20px 0;
        }

        .position-question {
            background: rgba(0, 120, 212, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .value-card {
            background: white;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .value-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
            border-color: var(--microsoft-blue);
        }

        .value-card.selected {
            background: rgba(0, 120, 212, 0.05);
            border-color: var(--microsoft-blue);
        }

        .value-card i {
            font-size: 2rem;
            color: var(--microsoft-blue);
            margin-bottom: 15px;
        }

        .value-card h4 {
            color: var(--microsoft-gray);
            margin-bottom: 10px;
        }

        .value-card p {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .cover-letter-preview-btn {
            background: rgba(0, 120, 212, 0.05);
            color: var(--microsoft-blue);
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
            transition: var(--transition);
        }

        .cover-letter-preview-btn:hover {
            background: rgba(0, 120, 212, 0.1);
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-header h1 {
                font-size: 2rem;
            }
            
            .form-content {
                padding: 25px;
            }
            
            .progress-container {
                padding: 0 20px;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 15px;
                padding: 0 25px 25px;
            }
            
            .btn {
                width: 100%;
            }
            
            .success-actions {
                flex-direction: column;
            }
            
            .steps-indicator {
                gap: 5px;
            }
            
            .step-label {
                font-size: 0.8rem;
                text-align: center;
            }

            .microsoft-header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }

            .save-resume-section {
                margin-left: 0;
                width: 100%;
            }

            .resume-code {
                font-size: 1.2rem;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .loading-content {
            background: white;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid var(--microsoft-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--microsoft-gray);
            margin-bottom: 15px;
        }

        .loading-subtext {
            color: var(--gray);
            font-size: 1rem;
        }

        .feature-badge {
            background: linear-gradient(135deg, var(--microsoft-accent), #e6a100);
            color: white;
            padding: 3px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            margin-left: 10px;
        }

        .feature-badge i {
            margin-right: 5px;
        }

        .counter {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--microsoft-blue);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(0, 120, 212, 0.4);
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--microsoft-success);
            border-radius: 50%;
            animation: confetti-fall 5s linear forwards;
            z-index: 1000;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="floating-shape shape-1"></div>
    <div class="floating-shape shape-2"></div>
    <div class="floating-shape shape-3"></div>

    <!-- Save Progress Modal -->
    <div class="modal" id="saveModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h2><i class="fas fa-save"></i> Save Your Progress</h2>
            </div>
            <div class="modal-body">
                <p>Your application progress has been saved. Use this unique code to resume your application later:</p>
                <div class="resume-code" id="resumeCodeDisplay">MSFT-5A8B3C</div>
                <div class="resume-instructions">
                    <p><strong>How to resume:</strong></p>
                    <p>1. Bookmark this page or note down your resume code</p>
                    <p>2. Return to this application portal</p>
                    <p>3. Click "Resume Application" and enter your code</p>
                </div>
                <p>We've also sent this code to your email for safekeeping.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Close</button>
                <button class="btn btn-primary" id="emailCodeBtn">
                    <i class="fas fa-envelope"></i> Email Me This Code
                </button>
            </div>
        </div>
    </div>

    <!-- Resume Application Modal -->
    <div class="modal" id="resumeModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h2><i class="fas fa-redo"></i> Resume Application</h2>
            </div>
            <div class="modal-body">
                <p>Enter your resume code to continue your application:</p>
                <input type="text" class="form-input" id="resumeCodeInput" placeholder="Enter your resume code (e.g. MSFT-5A8B3C)" style="margin: 15px 0;">
                <div class="char-counter" id="resumeCodeStatus">Code should be 10 characters</div>
                <div class="resume-instructions">
                    <p><strong>Don't have a code?</strong></p>
                    <p>If you previously saved your progress, you should have received a resume code via email.</p>
                    <p>Otherwise, you can start a <a href="#" id="newApplicationLink">new application</a>.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Cancel</button>
                <button class="btn btn-primary" id="resumeApplicationBtn">
                    <i class="fas fa-play"></i> Resume Application
                </button>
            </div>
        </div>
    </div>

    <!-- Cover Letter Preview Modal -->
    <div class="modal" id="coverLetterModal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h2><i class="fas fa-file-alt"></i> Cover Letter Preview</h2>
            </div>
            <div class="modal-body">
                <div style="background: white; border: 1px solid #e1e1e1; border-radius: 6px; padding: 20px; min-height: 300px;">
                    <h3 style="color: var(--microsoft-gray); margin-bottom: 15px;">Cover Letter</h3>
                    <div id="coverLetterPreviewContent" style="line-height: 1.6; color: #444;">
                        <!-- Preview content will be inserted here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary close-modal">Close Preview</button>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Processing Your Application</div>
            <div class="loading-subtext">We're carefully reviewing your submission...</div>
        </div>
    </div>

    <div class="form-container">
        <div class="microsoft-header">
            <div class="microsoft-logo">
                <i class="fab fa-microsoft"></i>
                <span>Microsoft Careers</span>
            </div>
            <div class="save-resume-section">
                <button class="btn btn-outline" id="saveLaterBtn">
                    <i class="fas fa-save"></i> Save Progress
                </button>
                <button class="btn btn-outline" id="showResumeModalBtn">
                    <i class="fas fa-redo"></i> Resume Application
                </button>
            </div>
        </div>

        <div class="counter">1/5</div>
        <div class="form-header">
            <div class="form-header-content">
                <h1>Microsoft Career Application</h1>
                <p>Empower every person and organization on the planet to achieve more</p>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="steps-indicator">
                <div class="step-indicator active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Personal Info</div>
                </div>
                <div class="step-indicator" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Experience</div>
                </div>
                <div class="step-indicator" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Preferences</div>
                </div>
                <div class="step-indicator" data-step="4">
                    <div class="step-circle">4</div>
                    <div class="step-label">Microsoft Values</div>
                </div>
                <div class="step-indicator" data-step="5">
                    <div class="step-circle">5</div>
                    <div class="step-label">Review</div>
                </div>
            </div>
        </div>

        <div class="form-content">
            <!-- Step 1: Personal Information -->
            <div class="step active" id="step1">
                <h2 class="step-title">Personal Information</h2>
                <p class="step-description">Tell us about yourself to get started. All fields marked with * are required.</p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="firstName"><i class="fas fa-user"></i>First Name *</label>
                        <input type="text" class="form-input" id="firstName" placeholder="John" required>
                        <div class="error-message" id="firstNameError">Please enter your first name</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="lastName"><i class="fas fa-user"></i>Last Name *</label>
                        <input type="text" class="form-input" id="lastName" placeholder="Doe" required>
                        <div class="error-message" id="lastNameError">Please enter your last name</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="email"><i class="fas fa-envelope"></i>Email Address *</label>
                        <input type="email" class="form-input" id="email" placeholder="john.doe@example.com" required>
                        <div class="error-message" id="emailError">Please enter a valid email address</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="phone"><i class="fas fa-phone"></i>Phone Number *</label>
                        <input type="tel" class="form-input" id="phone" placeholder="(123) 456-7890" required>
                        <div class="error-message" id="phoneError">Please enter a valid phone number</div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="address"><i class="fas fa-map-marker-alt"></i>Address *</label>
                        <input type="text" class="form-input" id="address" placeholder="123 Main St, Apt 4B" required>
                        <div class="error-message" id="addressError">Please enter your address</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="city"><i class="fas fa-city"></i>City *</label>
                        <input type="text" class="form-input" id="city" placeholder="Redmond" required>
                        <div class="error-message" id="cityError">Please enter your city</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="zipCode"><i class="fas fa-mail-bulk"></i>ZIP Code *</label>
                        <input type="text" class="form-input" id="zipCode" placeholder="98052" required>
                        <div class="error-message" id="zipCodeError">Please enter your ZIP code</div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="linkedin"><i class="fab fa-linkedin"></i>LinkedIn Profile</label>
                        <input type="url" class="form-input" id="linkedin" placeholder="https://linkedin.com/in/yourprofile">
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="accountPassword"><i class="fas fa-lock"></i>Create Account Password *</label>
                        <input type="password" class="form-input" id="accountPassword" placeholder="Create a strong password" required>
                        <div class="password-strength">
                            <div class="password-strength-fill" id="passwordStrengthFill"></div>
                        </div>
                        <div class="strength-label" id="passwordStrengthLabel">Password strength: Weak</div>
                        <div class="error-message" id="passwordError">Password must be at least 8 characters with uppercase, lowercase, number, and symbol</div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Experience -->
            <div class="step" id="step2">
                <h2 class="step-title">Professional Experience</h2>
                <p class="step-description">Share your background and qualifications. <span class="feature-badge"><i class="fas fa-star"></i>Enhanced</span></p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="position"><i class="fas fa-briefcase"></i>Position Applied For *</label>
                        <select class="form-select" id="position" required>
                            <option value="">Select a position</option>
                            <option value="software-engineer">Software Engineer</option>
                            <option value="product-manager">Product Manager</option>
                            <option value="data-scientist">Data Scientist</option>
                            <option value="ux-designer">UX Designer</option>
                            <option value="cloud-architect">Cloud Solutions Architect</option>
                            <option value="security-engineer">Security Engineer</option>
                            <option value="ai-researcher">AI Researcher</option>
                            <option value="devops-engineer">DevOps Engineer</option>
                        </select>
                        <div class="error-message" id="positionError">Please select a position</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="experience"><i class="fas fa-chart-line"></i>Years of Experience *</label>
                        <select class="form-select" id="experience" required>
                            <option value="">Select experience level</option>
                            <option value="0-1">0-1 years</option>
                            <option value="2-3">2-3 years</option>
                            <option value="4-5">4-5 years</option>
                            <option value="6-10">6-10 years</option>
                            <option value="10+">10+ years</option>
                        </select>
                        <div class="error-message" id="experienceError">Please select your experience level</div>
                    </div>
                    
                    <!-- Position-specific questions -->
                    <div class="position-question" id="softwareEngineerQuestion">
                        <h4><i class="fas fa-code"></i> Software Engineer Question</h4>
                        <p>Describe a challenging technical problem you solved and the approach you took.</p>
                        <textarea class="form-textarea" id="softwareEngineerAnswer" placeholder="Your answer..."></textarea>
                        <div class="char-counter">0/500 characters</div>
                    </div>
                    
                    <div class="position-question" id="productManagerQuestion">
                        <h4><i class="fas fa-tasks"></i> Product Manager Question</h4>
                        <p>How would you prioritize features for a new product with limited resources?</p>
                        <textarea class="form-textarea" id="productManagerAnswer" placeholder="Your answer..."></textarea>
                        <div class="char-counter">0/500 characters</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="currentCompany"><i class="fas fa-building"></i>Current Company</label>
                        <input type="text" class="form-input" id="currentCompany" placeholder="Company Name">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="salary"><i class="fas fa-dollar-sign"></i>Expected Salary (USD) *</label>
                        <input type="number" class="form-input" id="salary" placeholder="120000" required>
                        <div class="error-message" id="salaryError">Please enter your expected salary</div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="skills"><i class="fas fa-code"></i>Key Skills *</label>
                        <div class="skills-input-container">
                            <input type="text" class="form-input" id="skills" placeholder="Type a skill and press Enter (e.g., JavaScript, Azure, React)" required>
                            <div class="skills-suggestions" id="skillsSuggestions"></div>
                        </div>
                        <div class="error-message" id="skillsError">Please enter your key skills</div>
                        <div class="skill-tag-container" id="skillsPreview">
                            <!-- Skill tags will be added here -->
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="coverLetter"><i class="fas fa-file-alt"></i>Cover Letter *</label>
                        <textarea class="form-textarea" id="coverLetter" placeholder="Tell us why you're passionate about technology and how you align with Microsoft's mission..." required></textarea>
                        <div class="error-message" id="coverLetterError">Please write a cover letter (minimum 200 characters)</div>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <small id="charCount">0 characters</small>
                            <small id="charMin">Minimum 200 characters</small>
                        </div>
                        <button class="cover-letter-preview-btn" id="previewCoverLetterBtn">
                            <i class="fas fa-eye"></i> Preview Cover Letter
                        </button>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="resume"><i class="fas fa-file-upload"></i>Upload Resume (PDF, DOC, DOCX) *</label>
                        <div style="display: flex; gap: 15px; align-items: center;">
                            <input type="file" class="form-input" id="resume" accept=".pdf,.doc,.docx" style="flex: 1;" required>
                            <button type="button" class="btn btn-secondary" id="resumeHelp" style="width: auto;">
                                <i class="fas fa-question-circle"></i>
                            </button>
                        </div>
                        <div class="error-message" id="resumeError">Please upload your resume</div>
                        <div id="resumePreview" style="margin-top: 10px; display: none;">
                            <i class="fas fa-file-pdf" style="color: #e74c3c; margin-right: 5px;"></i>
                            <span id="resumeFileName"></span>
                            <div class="resume-actions">
                                <button class="btn btn-outline" id="removeResumeBtn" style="padding: 5px 10px; font-size: 0.9rem;">
                                    <i class="fas fa-trash"></i> Remove
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Preferences -->
            <div class="step" id="step3">
                <h2 class="step-title">Work Preferences</h2>
                <p class="step-description">Help us understand your ideal work environment</p>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="workType"><i class="fas fa-laptop-house"></i>Work Type *</label>
                        <select class="form-select" id="workType" required>
                            <option value="">Select work type</option>
                            <option value="remote">Remote</option>
                            <option value="hybrid">Hybrid</option>
                            <option value="onsite">On-site</option>
                        </select>
                        <div class="error-message" id="workTypeError">Please select your preferred work type</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="startDate"><i class="fas fa-calendar-check"></i>Available Start Date *</label>
                        <input type="date" class="form-input" id="startDate" required>
                        <div class="error-message" id="startDateError">Please select your availability</div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label"><i class="fas fa-lightbulb"></i>Interested Areas (Select all that apply) *</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" class="checkbox-input" id="cloud-computing" value="cloud-computing">
                                <label class="checkbox-label" for="cloud-computing">Cloud Computing (Azure)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="checkbox-input" id="ai-ml" value="ai-ml">
                                <label class="checkbox-label" for="ai-ml">Artificial Intelligence & Machine Learning</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="checkbox-input" id="product-development" value="product-development">
                                <label class="checkbox-label" for="product-development">Product Development</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="checkbox-input" id="security" value="security">
                                <label class="checkbox-label" for="security">Security & Compliance</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="checkbox-input" id="data-analytics" value="data-analytics">
                                <label class="checkbox-label" for="data-analytics">Data Analytics</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" class="checkbox-input" id="gaming" value="gaming">
                                <label class="checkbox-label" for="gaming">Gaming & Entertainment</label>
                            </div>
                        </div>
                        <div class="error-message" id="interestsError">Please select at least one area of interest</div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="portfolio"><i class="fas fa-globe"></i>Portfolio/GitHub URL</label>
                        <input type="url" class="form-input" id="portfolio" placeholder="https://github.com/yourusername">
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label" for="additionalInfo"><i class="fas fa-comment-alt"></i>Additional Information</label>
                        <textarea class="form-textarea" id="additionalInfo" placeholder="Anything else you'd like us to know? (e.g., certifications, awards, publications)"></textarea>
                        <div class="char-counter">0/1000 characters</div>
                    </div>
                    <div class="form-group full-width">
                        <label class="form-label"><i class="fas fa-bullhorn"></i>How did you hear about us?</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="radio" class="checkbox-input" name="referral" id="linkedinRef" value="linkedin">
                                <label class="checkbox-label" for="linkedinRef">LinkedIn</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" class="checkbox-input" name="referral" id="microsoft-careers" value="microsoft-careers">
                                <label class="checkbox-label" for="microsoft-careers">Microsoft Careers Website</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" class="checkbox-input" name="referral" id="employee" value="employee">
                                <label class="checkbox-label" for="employee">Microsoft Employee Referral</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" class="checkbox-input" name="referral" id="event" value="event">
                                <label class="checkbox-label" for="event">Career Event or Conference</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" class="checkbox-input" name="referral" id="other" value="other">
                                <label class="checkbox-label" for="other">Other</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Microsoft Values Alignment -->
            <div class="step" id="step4">
                <h2 class="step-title">Microsoft Culture Fit</h2>
                <p class="step-description">At Microsoft, we value diversity, inclusion, and innovation. Tell us how you align with our core values.</p>
                
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label class="form-label"><i class="fas fa-heart"></i> Microsoft Core Values</label>
                        <p>Select the values that resonate most with you (choose 2-3):</p>
                        <div class="values-grid">
                            <div class="value-card" data-value="innovation">
                                <i class="fas fa-lightbulb"></i>
                                <h4>Innovation</h4>
                                <p>Creating new solutions to empower others</p>
                            </div>
                            <div class="value-card" data-value="diversity">
                                <i class="fas fa-users"></i>
                                <h4>Diversity & Inclusion</h4>
                                <p>Valuing different perspectives and backgrounds</p>
                            </div>
                            <div class="value-card" data-value="growth">
                                <i class="fas fa-seedling"></i>
                                <h4>Growth Mindset</h4>
                                <p>Embracing challenges and learning from failures</p>
                            </div>
                            <div class="value-card" data-value="impact">
                                <i class="fas fa-globe-americas"></i>
                                <h4>Global Impact</h4>
                                <p>Striving to make a difference worldwide</p>
                            </div>
                            <div class="value-card" data-value="collaboration">
                                <i class="fas fa-hands-helping"></i>
                                <h4>Collaboration</h4>
                                <p>Working together to achieve more</p>
                            </div>
                            <div class="value-card" data-value="integrity">
                                <i class="fas fa-shield-alt"></i>
                                <h4>Integrity</h4>
                                <p>Doing the right thing with honesty and ethics</p>
                            </div>
                        </div>
                        <input type="hidden" id="selectedValues">
                        <div class="error-message" id="valuesError">Please select 2-3 values that resonate with you</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label" for="valuesExplanation"><i class="fas fa-comment"></i>Values Alignment *</label>
                        <textarea class="form-textarea" id="valuesExplanation" placeholder="Explain how you've embodied these values in your professional experience..." required></textarea>
                        <div class="error-message" id="valuesExplanationError">Please explain how you align with these values</div>
                        <div class="char-counter">0/500 characters</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label" for="diversityStatement"><i class="fas fa-hands"></i>Diversity & Inclusion *</label>
                        <textarea class="form-textarea" id="diversityStatement" placeholder="Share how you've contributed to creating inclusive environments..." required></textarea>
                        <div class="error-message" id="diversityError">Please share your perspective on diversity and inclusion</div>
                        <div class="char-counter">0/500 characters</div>
                    </div>
                </div>
            </div>

            <!-- Step 5: Review -->
            <div class="step" id="step5">
                <h2 class="step-title">Review Your Application</h2>
                <p class="step-description">Please review all information before submitting to Microsoft</p>
                
                <div class="review-section">
                    <h3><i class="fas fa-user-circle"></i>Personal Information</h3>
                    <div class="review-item">
                        <span class="review-label">Name:</span>
                        <span class="review-value" id="reviewName"></span>
                        <span class="edit-icon" data-step="1"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Email:</span>
                        <span class="review-value" id="reviewEmail"></span>
                        <span class="edit-icon" data-step="1"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Phone:</span>
                        <span class="review-value" id="reviewPhone"></span>
                        <span class="edit-icon" data-step="1"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Location:</span>
                        <span class="review-value" id="reviewLocation"></span>
                        <span class="edit-icon" data-step="1"><i class="fas fa-edit"></i></span>
                    </div>
                </div>

                <div class="review-section">
                    <h3><i class="fas fa-briefcase"></i>Professional Experience</h3>
                    <div class="review-item">
                        <span class="review-label">Position:</span>
                        <span class="review-value" id="reviewPosition"></span>
                        <span class="edit-icon" data-step="2"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Experience:</span>
                        <span class="review-value" id="reviewExperience"></span>
                        <span class="edit-icon" data-step="2"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Current Company:</span>
                        <span class="review-value" id="reviewCompany"></span>
                        <span class="edit-icon" data-step="2"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Expected Salary:</span>
                        <span class="review-value" id="reviewSalary"></span>
                        <span class="edit-icon" data-step="2"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Key Skills:</span>
                        <span class="review-value" id="reviewSkills"></span>
                        <span class="edit-icon" data-step="2"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Position-specific Answer:</span>
                        <span class="review-value" id="reviewPositionAnswer"></span>
                        <span class="edit-icon" data-step="2"><i class="fas fa-edit"></i></span>
                    </div>
                </div>

                <div class="review-section">
                    <h3><i class="fas fa-cogs"></i>Work Preferences</h3>
                    <div class="review-item">
                        <span class="review-label">Work Type:</span>
                        <span class="review-value" id="reviewWorkType"></span>
                        <span class="edit-icon" data-step="3"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Start Date:</span>
                        <span class="review-value" id="reviewStartDate"></span>
                        <span class="edit-icon" data-step="3"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Interests:</span>
                        <span class="review-value" id="reviewInterests"></span>
                        <span class="edit-icon" data-step="3"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Portfolio/GitHub:</span>
                        <span class="review-value" id="reviewPortfolio"></span>
                        <span class="edit-icon" data-step="3"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Referral Source:</span>
                        <span class="review-value" id="reviewReferral"></span>
                        <span class="edit-icon" data-step="3"><i class="fas fa-edit"></i></span>
                    </div>
                </div>

                <div class="review-section">
                    <h3><i class="fas fa-heart"></i>Microsoft Values Alignment</h3>
                    <div class="review-item">
                        <span class="review-label">Selected Values:</span>
                        <span class="review-value" id="reviewValues"></span>
                        <span class="edit-icon" data-step="4"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Values Explanation:</span>
                        <span class="review-value" id="reviewValuesExplanation"></span>
                        <span class="edit-icon" data-step="4"><i class="fas fa-edit"></i></span>
                    </div>
                    <div class="review-item">
                        <span class="review-label">Diversity Statement:</span>
                        <span class="review-value" id="reviewDiversity"></span>
                        <span class="edit-icon" data-step="4"><i class="fas fa-edit"></i></span>
                    </div>
                </div>
            </div>

            <!-- Success Message -->
            <div class="step" id="successStep">
                <div class="success-message">
                    <div class="success-icon">âœ“</div>
                    <h2 class="success-title">Application Submitted!</h2>
                    <p class="success-text">Thank you for your application to join Microsoft. We've received your submission and our talent acquisition team will review it carefully. You'll receive a confirmation email shortly.</p>
                    <p class="success-text">We aim to respond to all applications within 5 business days. In the meantime, we encourage you to explore the Microsoft Careers portal to learn more about our culture and opportunities.</p>
                    
                    <div class="success-actions">
                        <button class="btn btn-primary" id="dashboardBtn">
                            <i class="fas fa-tachometer-alt"></i> Go to Candidate Dashboard
                        </button>
                        <button class="btn btn-outline" id="newApplicationBtn">
                            <i class="fas fa-file-alt"></i> Submit Another Application
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-actions">
            <button type="button" class="btn btn-secondary" id="prevBtn" style="display: none;">
                <i class="fas fa-arrow-left"></i> Previous
            </button>
            <button type="button" class="btn btn-primary" id="nextBtn">
                Next Step <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <script>
        class MultiStepForm {
            constructor() {
                this.currentStep = 1;
                this.totalSteps = 5;
                this.formData = {};
                this.skillTags = [];
                this.skillSuggestions = [
                    "JavaScript", "TypeScript", "React", "Angular", "Vue.js", "Node.js", 
                    "Python", "Java", "C#", ".NET", "Azure", "AWS", "Docker", "Kubernetes",
                    "SQL", "NoSQL", "Git", "CI/CD", "REST API", "GraphQL", "Machine Learning",
                    "TensorFlow", "PyTorch", "Data Analysis", "Power BI", "UI/UX Design",
                    "Agile", "Scrum", "Project Management", "Cybersecurity", "DevOps"
                ];
                this.selectedValues = [];
                this.positionQuestions = {
                    "software-engineer": "softwareEngineerQuestion",
                    "product-manager": "productManagerQuestion"
                };
                this.init();
                this.loadSavedData();
            }

            init() {
                this.bindEvents();
                this.updateProgress();
                this.setupRealTimeValidation();
                this.populateSkillSuggestions();
            }

            bindEvents() {
                document.getElementById('nextBtn').addEventListener('click', () => this.nextStep());
                document.getElementById('prevBtn').addEventListener('click', () => this.prevStep());
                
                // Step indicator click
                document.querySelectorAll('.step-indicator').forEach(indicator => {
                    indicator.addEventListener('click', (e) => {
                        const step = parseInt(e.currentTarget.dataset.step);
                        if (step < this.currentStep) {
                            this.currentStep = step;
                            this.updateStep();
                            this.updateProgress();
                        }
                    });
                });

                // Resume file change
                document.getElementById('resume').addEventListener('change', (e) => {
                    this.handleFileUpload(e.target);
                });

                // Remove resume button
                document.getElementById('removeResumeBtn')?.addEventListener('click', () => {
                    this.removeResume();
                });

                // Cover letter character count
                document.getElementById('coverLetter').addEventListener('input', (e) => {
                    this.updateCharCount(e.target);
                });

                // Skills input
                document.getElementById('skills').addEventListener('input', (e) => {
                    this.updateSkillSuggestions(e.target.value);
                });

                document.getElementById('skills').addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ',') {
                        e.preventDefault();
                        this.addSkillTag(document.getElementById('skills').value.trim());
                        document.getElementById('skills').value = '';
                        this.updateSkillSuggestions('');
                    }
                });

                // Save data on input
                document.querySelectorAll('.form-input, .form-select, .form-textarea, .checkbox-input').forEach(input => {
                    input.addEventListener('input', () => this.saveData());
                    input.addEventListener('change', () => this.saveData());
                });

                // Resume help button
                document.getElementById('resumeHelp').addEventListener('click', () => {
                    alert("Please upload your resume in PDF, DOC, or DOCX format. Maximum file size is 5MB. Your resume should highlight your most relevant experience and skills for the position you're applying for at Microsoft.");
                });

                // Dashboard button
                document.getElementById('dashboardBtn').addEventListener('click', () => {
                    alert("Microsoft Candidate Dashboard would open here. You can track your application status, update your profile, and explore other opportunities.");
                });

                // New application button
                document.getElementById('newApplicationBtn').addEventListener('click', () => {
                    location.reload();
                });

                // Save progress button
                document.getElementById('saveLaterBtn').addEventListener('click', () => {
                    this.showSaveModal();
                });

                // Show resume modal button
                document.getElementById('showResumeModalBtn').addEventListener('click', () => {
                    this.showResumeModal();
                });

                // Resume application button
                document.getElementById('resumeApplicationBtn').addEventListener('click', () => {
                    this.resumeApplication();
                });

                // Email code button
                document.getElementById('emailCodeBtn').addEventListener('click', () => {
                    this.emailResumeCode();
                });

                // Close modals
                document.querySelectorAll('.close-modal').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.modal').forEach(modal => {
                            modal.style.display = 'none';
                        });
                    });
                });

                // Cover letter preview
                document.getElementById('previewCoverLetterBtn').addEventListener('click', () => {
                    this.previewCoverLetter();
                });

                // Position change
                document.getElementById('position').addEventListener('change', (e) => {
                    this.togglePositionQuestions(e.target.value);
                });

                // Value card selection
                document.querySelectorAll('.value-card').forEach(card => {
                    card.addEventListener('click', () => {
                        this.toggleValueSelection(card);
                    });
                });

                // Edit review items
                document.querySelectorAll('.edit-icon').forEach(icon => {
                    icon.addEventListener('click', (e) => {
                        const step = e.currentTarget.getAttribute('data-step');
                        this.currentStep = parseInt(step);
                        this.updateStep();
                        this.updateProgress();
                    });
                });

                // Password strength
                document.getElementById('accountPassword').addEventListener('input', (e) => {
                    this.updatePasswordStrength(e.target.value);
                });

                // New application link
                document.getElementById('newApplicationLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    location.reload();
                });
            }

            validateField(field) {
                const value = field.value.trim();
                const fieldId = field.id;
                let isValid = true;

                // Clear previous error
                this.clearError(field);

                if (field.hasAttribute('required') && !value) {
                    this.showError(field, 'This field is required');
                    isValid = false;
                } else {
                    // Specific validations
                    switch (fieldId) {
                        case 'email':
                            if (value && !this.isValidEmail(value)) {
                                this.showError(field, 'Please enter a valid email address');
                                isValid = false;
                            }
                            break;
                        case 'phone':
                            if (value && !this.isValidPhone(value)) {
                                this.showError(field, 'Please enter a valid phone number');
                                isValid = false;
                            }
                            break;
                        case 'zipCode':
                            if (value && !this.isValidZipCode(value)) {
                                this.showError(field, 'Please enter a valid ZIP code');
                                isValid = false;
                            }
                            break;
                        case 'salary':
                            if (value && (isNaN(value) || parseInt(value) < 0)) {
                                this.showError(field, 'Please enter a valid salary amount');
                                isValid = false;
                            }
                            break;
                        case 'portfolio':
                            if (value && !this.isValidURL(value)) {
                                this.showError(field, 'Please enter a valid URL');
                                isValid = false;
                            }
                            break;
                        case 'coverLetter':
                            if (value && value.length < 200) {
                                this.showError(field, 'Cover letter must be at least 200 characters');
                                isValid = false;
                            }
                            break;
                        case 'accountPassword':
                            if (value && !this.isStrongPassword(value)) {
                                this.showError(field, 'Password must be at least 8 characters with uppercase, lowercase, number, and symbol');
                                isValid = false;
                            }
                            break;
                    }
                }

                return isValid;
            }

            validateStep(step) {
                const stepElement = document.getElementById(`step${step}`);
                const inputs = stepElement.querySelectorAll('.form-input[required], .form-select[required], .form-textarea[required]');
                let isValid = true;

                inputs.forEach(input => {
                    if (!this.validateField(input)) {
                        isValid = false;
                    }
                });

                // Special validation for step 2
                if (step === 2) {
                    const resumeInput = document.getElementById('resume');
                    if (!resumeInput.files || resumeInput.files.length === 0) {
                        this.showError(resumeInput, 'Please upload your resume');
                        isValid = false;
                    } else {
                        this.clearError(resumeInput);
                    }
                    
                    const coverLetter = document.getElementById('coverLetter');
                    if (coverLetter.value.length < 200) {
                        this.showError(coverLetter, 'Cover letter must be at least 200 characters');
                        isValid = false;
                    }
                    
                    if (this.skillTags.length === 0) {
                        this.showError(document.getElementById('skills'), 'Please add at least one skill');
                        isValid = false;
                    }
                }

                // Special validation for interests checkboxes in step 3
                if (step === 3) {
                    const checkboxes = stepElement.querySelectorAll('.checkbox-input');
                    const checkedBoxes = Array.from(checkboxes).filter(cb => cb.checked);
                    
                    if (checkedBoxes.length === 0) {
                        this.showError(document.getElementById('cloud-computing'), 'Please select at least one area of interest');
                        document.getElementById('interestsError').classList.add('show');
                        isValid = false;
                    } else {
                        document.getElementById('interestsError').classList.remove('show');
                    }
                    
                    // Validate at least one referral radio is selected
                    const referralRadios = document.querySelectorAll('input[name="referral"]');
                    const referralSelected = Array.from(referralRadios).some(radio => radio.checked);
                    if (!referralSelected) {
                        this.showError(document.getElementById('linkedinRef'), 'Please select how you heard about us');
                        isValid = false;
                    }
                }
                
                // Special validation for values in step 4
                if (step === 4) {
                    if (this.selectedValues.length < 2 || this.selectedValues.length > 3) {
                        document.getElementById('valuesError').classList.add('show');
                        isValid = false;
                    } else {
                        document.getElementById('valuesError').classList.remove('show');
                    }
                    
                    const valuesExplanation = document.getElementById('valuesExplanation');
                    if (valuesExplanation.value.trim().length === 0) {
                        this.showError(valuesExplanation, 'Please explain how you align with these values');
                        isValid = false;
                    }
                    
                    const diversityStatement = document.getElementById('diversityStatement');
                    if (diversityStatement.value.trim().length === 0) {
                        this.showError(diversityStatement, 'Please share your perspective on diversity and inclusion');
                        isValid = false;
                    }
                }

                return isValid;
            }

            showError(field, message) {
                field.classList.add('error');
                const errorElement = document.getElementById(field.id + 'Error');
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.add('show');
                }
            }

            clearError(field) {
                field.classList.remove('error');
                const errorElement = document.getElementById(field.id + 'Error');
                if (errorElement) {
                    errorElement.classList.remove('show');
                }
            }

            isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            isValidPhone(phone) {
                const phoneRegex = /^[\+]?[1-9][\d]{0,15}$/;
                return phoneRegex.test(phone.replace(/[\s\-\(\)]/g, ''));
            }

            isValidZipCode(zipCode) {
                const zipRegex = /^\d{5}(-\d{4})?$/;
                return zipRegex.test(zipCode);
            }

            isValidURL(url) {
                try {
                    new URL(url);
                    return true;
                } catch {
                    return false;
                }
            }
            
            isStrongPassword(password) {
                // At least 8 characters, one uppercase, one lowercase, one number, one special character
                const strongRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
                return strongRegex.test(password);
            }

            nextStep() {
                if (this.currentStep < this.totalSteps) {
                    if (this.validateStep(this.currentStep)) {
                        this.saveData();
                        this.currentStep++;
                        this.updateStep();
                        this.updateProgress();
                        
                        if (this.currentStep === 5) {
                            this.populateReview();
                        }
                    }
                } else if (this.currentStep === this.totalSteps) {
                    this.submitForm();
                }
            }

            prevStep() {
                if (this.currentStep > 1) {
                    this.currentStep--;
                    this.updateStep();
                    this.updateProgress();
                }
            }

            updateStep() {
                // Hide all steps
                document.querySelectorAll('.step').forEach(step => {
                    step.classList.remove('active');
                });

                // Show current step
                document.getElementById(`step${this.currentStep}`).classList.add('active');

                // Update button states
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');

                if (this.currentStep === 1) {
                    prevBtn.style.display = 'none';
                } else {
                    prevBtn.style.display = 'inline-block';
                }

                if (this.currentStep === this.totalSteps) {
                    nextBtn.innerHTML = 'Submit Application <i class="fas fa-paper-plane"></i>';
                } else {
                    nextBtn.innerHTML = 'Next Step <i class="fas fa-arrow-right"></i>';
                }

                // Update step indicators
                document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                    const stepNum = index + 1;
                    indicator.classList.remove('active', 'completed');
                    
                    if (stepNum === this.currentStep) {
                        indicator.classList.add('active');
                    } else if (stepNum < this.currentStep) {
                        indicator.classList.add('completed');
                    }
                });
                
                // Update counter
                document.querySelector('.counter').textContent = `${this.currentStep}/${this.totalSteps}`;
            }

            updateProgress() {
                const progressFill = document.getElementById('progressFill');
                const progressPercentage = (this.currentStep / this.totalSteps) * 100;
                progressFill.style.width = progressPercentage + '%';
            }

            saveData() {
                const formData = {};
                
                // Save all form inputs
                document.querySelectorAll('.form-input, .form-select, .form-textarea').forEach(input => {
                    formData[input.id] = input.value;
                });

                // Save checkboxes
                document.querySelectorAll('.checkbox-input').forEach(checkbox => {
                    formData[checkbox.id] = checkbox.checked;
                });

                // Save radio buttons
                const referralRadios = document.querySelectorAll('input[name="referral"]');
                referralRadios.forEach(radio => {
                    if (radio.checked) {
                        formData['referral'] = radio.value;
                    }
                });
                
                // Save skill tags
                formData.skillTags = this.skillTags;
                
                // Save selected values
                formData.selectedValues = this.selectedValues;
                
                // Save position-specific answers
                formData.softwareEngineerAnswer = document.getElementById('softwareEngineerAnswer')?.value || '';
                formData.productManagerAnswer = document.getElementById('productManagerAnswer')?.value || '';

                // Save current step
                formData.currentStep = this.currentStep;

                // Store in localStorage
                localStorage.setItem('microsoftJobApplicationData', JSON.stringify(formData));
            }

            loadSavedData() {
                const savedData = localStorage.getItem('microsoftJobApplicationData');
                if (savedData) {
                    this.formData = JSON.parse(savedData);
                    
                    if (this.formData.currentStep) {
                        this.currentStep = this.formData.currentStep;
                        this.updateStep();
                        this.updateProgress();
                    }

                    // Load saved values
                    Object.keys(this.formData).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            if (element.type === 'checkbox' || element.type === 'radio') {
                                element.checked = this.formData[key];
                            } else {
                                element.value = this.formData[key];
                            }
                        }
                    });
                    
                    // Load skill tags
                    if (this.formData.skillTags) {
                        this.skillTags = this.formData.skillTags;
                        this.updateSkillsPreview();
                    }
                    
                    // Load selected values
                    if (this.formData.selectedValues) {
                        this.selectedValues = this.formData.selectedValues;
                        this.updateSelectedValuesDisplay();
                    }
                    
                    // Load position-specific questions
                    if (this.formData.position) {
                        this.togglePositionQuestions(this.formData.position);
                    }

                    // Update character count
                    if (this.formData.coverLetter) {
                        this.updateCharCount(document.getElementById('coverLetter'));
                    }
                    
                    // Update resume preview if exists
                    if (this.formData.resumeName) {
                        document.getElementById('resumePreview').style.display = 'block';
                        document.getElementById('resumeFileName').textContent = this.formData.resumeName;
                    }
                    
                    // Update password strength
                    if (this.formData.accountPassword) {
                        this.updatePasswordStrength(this.formData.accountPassword);
                    }
                }
            }

            handleFileUpload(input) {
                if (input.files && input.files[0]) {
                    const file = input.files[0];
                    const fileName = file.name;
                    const fileSize = file.size / 1024 / 1024; // in MB
                    const validTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
                    
                    if (!validTypes.includes(file.type)) {
                        this.showError(input, 'Please upload a PDF, DOC, or DOCX file');
                        input.value = '';
                        return;
                    }
                    
                    if (fileSize > 5) {
                        this.showError(input, 'File size exceeds 5MB limit');
                        input.value = '';
                        return;
                    }
                    
                    this.clearError(input);
                    
                    // Show file preview
                    document.getElementById('resumePreview').style.display = 'block';
                    document.getElementById('resumeFileName').textContent = fileName;
                    
                    // Save file info
                    this.formData.resumeName = fileName;
                    this.saveData();
                }
            }
            
            removeResume() {
                document.getElementById('resume').value = '';
                document.getElementById('resumePreview').style.display = 'none';
                delete this.formData.resumeName;
                this.saveData();
            }

            updateCharCount(textarea) {
                const charCount = textarea.value.length;
                const minChars = textarea.id === 'coverLetter' ? 200 : 0;
                document.getElementById('charCount').textContent = `${charCount} characters`;
                
                if (charCount < minChars) {
                    textarea.classList.add('error');
                    document.getElementById('coverLetterError').classList.add('show');
                } else {
                    textarea.classList.remove('error');
                    document.getElementById('coverLetterError').classList.remove('show');
                }
                
                // Update char counters for other fields
                const charCounter = textarea.parentElement.querySelector('.char-counter');
                if (charCounter) {
                    const maxChars = charCounter.textContent.split('/')[1].replace(' characters', '').trim();
                    charCounter.textContent = `${charCount}/${maxChars} characters`;
                }
            }
            
            updatePasswordStrength(password) {
                let strength = 0;
                const strengthFill = document.getElementById('passwordStrengthFill');
                const strengthLabel = document.getElementById('passwordStrengthLabel');
                
                if (password.length >= 8) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;
                
                strengthFill.className = 'password-strength-fill';
                strengthFill.classList.add(`strength-${strength}`);
                
                const labels = ['Very Weak', 'Weak', 'Medium', 'Strong', 'Very Strong'];
                strengthLabel.textContent = `Password strength: ${labels[strength]}`;
                strengthLabel.style.color = strength >= 3 ? '#107c10' : '#d83b01';
            }

            addSkillTag(skill) {
                if (skill && !this.skillTags.includes(skill)) {
                    this.skillTags.push(skill);
                    this.updateSkillsPreview();
                    this.saveData();
                }
            }
            
            removeSkillTag(skill) {
                this.skillTags = this.skillTags.filter(tag => tag !== skill);
                this.updateSkillsPreview();
                this.saveData();
            }
            
            updateSkillsPreview() {
                const skillsPreview = document.getElementById('skillsPreview');
                skillsPreview.innerHTML = '';
                
                this.skillTags.forEach(skill => {
                    const tag = document.createElement('span');
                    tag.className = 'skill-tag';
                    tag.innerHTML = `${skill} <span class="remove-tag" data-skill="${skill}">&times;</span>`;
                    skillsPreview.appendChild(tag);
                    
                    tag.querySelector('.remove-tag').addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.removeSkillTag(skill);
                    });
                });
                
                // Hide suggestions
                document.getElementById('skillsSuggestions').style.display = 'none';
            }
            
            populateSkillSuggestions() {
                const suggestionsContainer = document.getElementById('skillsSuggestions');
                suggestionsContainer.innerHTML = '';
                
                this.skillSuggestions.forEach(skill => {
                    if (!this.skillTags.includes(skill)) {
                        const suggestion = document.createElement('div');
                        suggestion.className = 'suggestion-item';
                        suggestion.textContent = skill;
                        suggestion.addEventListener('click', () => {
                            this.addSkillTag(skill);
                            document.getElementById('skills').value = '';
                        });
                        suggestionsContainer.appendChild(suggestion);
                    }
                });
            }
            
            updateSkillSuggestions(query) {
                const suggestionsContainer = document.getElementById('skillsSuggestions');
                if (query) {
                    this.populateSkillSuggestions();
                    // Filter suggestions
                    const filtered = Array.from(suggestionsContainer.children).filter(item => 
                        item.textContent.toLowerCase().includes(query.toLowerCase())
                    );
                    
                    suggestionsContainer.innerHTML = '';
                    filtered.forEach(item => suggestionsContainer.appendChild(item));
                    
                    if (filtered.length > 0) {
                        suggestionsContainer.style.display = 'block';
                    } else {
                        suggestionsContainer.style.display = 'none';
                    }
                } else {
                    this.populateSkillSuggestions();
                    suggestionsContainer.style.display = 'none';
                }
            }
            
            togglePositionQuestions(position) {
                // Hide all position questions
                document.querySelectorAll('.position-question').forEach(question => {
                    question.style.display = 'none';
                });
                
                // Show relevant question if exists
                if (this.positionQuestions[position]) {
                    document.getElementById(this.positionQuestions[position]).style.display = 'block';
                }
            }
            
            toggleValueSelection(card) {
                const value = card.getAttribute('data-value');
                const index = this.selectedValues.indexOf(value);
                
                if (index === -1) {
                    if (this.selectedValues.length < 3) {
                        this.selectedValues.push(value);
                        card.classList.add('selected');
                    }
                } else {
                    this.selectedValues.splice(index, 1);
                    card.classList.remove('selected');
                }
                
                document.getElementById('selectedValues').value = this.selectedValues.join(',');
                this.saveData();
            }
            
            updateSelectedValuesDisplay() {
                document.querySelectorAll('.value-card').forEach(card => {
                    const value = card.getAttribute('data-value');
                    if (this.selectedValues.includes(value)) {
                        card.classList.add('selected');
                    } else {
                        card.classList.remove('selected');
                    }
                });
            }
            
            showSaveModal() {
                // Generate a unique resume code
                const code = 'MSFT-' + Math.random().toString(36).substr(2, 6).toUpperCase();
                document.getElementById('resumeCodeDisplay').textContent = code;
                document.getElementById('saveModal').style.display = 'flex';
                
                // Save the code in localStorage
                this.formData.resumeCode = code;
                localStorage.setItem(`microsoftJobApplication_${code}`, JSON.stringify(this.formData));
            }
            
            showResumeModal() {
                document.getElementById('resumeModal').style.display = 'flex';
            }
            
            resumeApplication() {
                const code = document.getElementById('resumeCodeInput').value.trim();
                if (!code) {
                    alert('Please enter your resume code');
                    return;
                }
                
                const savedData = localStorage.getItem(`microsoftJobApplication_${code}`);
                if (savedData) {
                    this.formData = JSON.parse(savedData);
                    localStorage.setItem('microsoftJobApplicationData', savedData);
                    
                    // Reload the form with saved data
                    location.reload();
                } else {
                    alert('Invalid resume code. Please check and try again.');
                }
            }
            
            emailResumeCode() {
                const code = document.getElementById('resumeCodeDisplay').textContent;
                const email = document.getElementById('email').value || 'your email';
                alert(`Resume code sent to ${email}. In a real application, this would be sent via email.`);
                document.getElementById('saveModal').style.display = 'none';
            }
            
            previewCoverLetter() {
                const content = document.getElementById('coverLetter').value;
                if (!content) {
                    alert('Please write your cover letter first');
                    return;
                }
                
                document.getElementById('coverLetterPreviewContent').textContent = content;
                document.getElementById('coverLetterModal').style.display = 'flex';
            }

            populateReview() {
                // Personal Information
                document.getElementById('reviewName').textContent = 
                    `${document.getElementById('firstName').value} ${document.getElementById('lastName').value}`;
                document.getElementById('reviewEmail').textContent = document.getElementById('email').value;
                document.getElementById('reviewPhone').textContent = document.getElementById('phone').value;
                document.getElementById('reviewLocation').textContent = 
                    `${document.getElementById('city').value}, ${document.getElementById('zipCode').value}`;

                // Professional Experience
                const positionSelect = document.getElementById('position');
                document.getElementById('reviewPosition').textContent = 
                    positionSelect.options[positionSelect.selectedIndex].text;
                
                const experienceSelect = document.getElementById('experience');
                document.getElementById('reviewExperience').textContent = 
                    experienceSelect.options[experienceSelect.selectedIndex].text;
                
                document.getElementById('reviewCompany').textContent = 
                    document.getElementById('currentCompany').value || 'Not provided';
                
                document.getElementById('reviewSalary').textContent = 
                    '$' + parseInt(document.getElementById('salary').value).toLocaleString();
                
                document.getElementById('reviewSkills').textContent = this.skillTags.join(', ') || 'No skills added';
                
                document.getElementById('reviewResume').textContent = 
                    this.formData.resumeName || 'No file uploaded';
                
                // Position-specific answers
                if (this.formData.softwareEngineerAnswer) {
                    document.getElementById('reviewPositionAnswer').textContent = 
                        this.formData.softwareEngineerAnswer.substring(0, 100) + '...';
                } else if (this.formData.productManagerAnswer) {
                    document.getElementById('reviewPositionAnswer').textContent = 
                        this.formData.productManagerAnswer.substring(0, 100) + '...';
                } else {
                    document.getElementById('reviewPositionAnswer').textContent = 'Not provided';
                }

                // Work Preferences
                const workTypeSelect = document.getElementById('workType');
                document.getElementById('reviewWorkType').textContent = 
                    workTypeSelect.options[workTypeSelect.selectedIndex].text;
                
                const startDate = new Date(document.getElementById('startDate').value);
                document.getElementById('reviewStartDate').textContent = 
                    startDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

                // Interests
                const interests = [];
                document.querySelectorAll('.checkbox-input:checked').forEach(checkbox => {
                    const label = document.querySelector(`label[for="${checkbox.id}"]`);
                    interests.push(label.textContent);
                });
                document.getElementById('reviewInterests').textContent = interests.join(', ') || 'None selected';

                // Portfolio
                document.getElementById('reviewPortfolio').textContent = 
                    document.getElementById('portfolio').value || 'Not provided';

                // Referral source
                const referralRadios = document.querySelectorAll('input[name="referral"]:checked');
                document.getElementById('reviewReferral').textContent = 
                    referralRadios.length > 0 ? document.querySelector(`label[for="${referralRadios[0].id}"]`).textContent : 'Not specified';
                
                // Values
                const valueLabels = {
                    "innovation": "Innovation",
                    "diversity": "Diversity & Inclusion",
                    "growth": "Growth Mindset",
                    "impact": "Global Impact",
                    "collaboration": "Collaboration",
                    "integrity": "Integrity"
                };
                
                const selectedValueLabels = this.selectedValues.map(val => valueLabels[val] || val);
                document.getElementById('reviewValues').textContent = selectedValueLabels.join(', ') || 'None selected';
                
                document.getElementById('reviewValuesExplanation').textContent = 
                    document.getElementById('valuesExplanation').value.substring(0, 100) + '...';
                
                document.getElementById('reviewDiversity').textContent = 
                    document.getElementById('diversityStatement').value.substring(0, 100) + '...';
            }

            createRipple(event) {
                const button = event.currentTarget;
                const circle = document.createElement("span");
                const diameter = Math.max(button.clientWidth, button.clientHeight);
                const radius = diameter / 2;
                
                circle.style.width = circle.style.height = `${diameter}px`;
                circle.style.left = `${event.clientX - button.offsetLeft - radius}px`;
                circle.style.top = `${event.clientY - button.offsetTop - radius}px`;
                circle.classList.add("ripple");
                
                const ripple = button.getElementsByClassName("ripple")[0];
                if (ripple) ripple.remove();
                
                button.appendChild(circle);
            }

            createConfetti() {
                const colors = ['#0078d4', '#106ebe', '#107c10', '#ffb900', '#5c2d91'];
                for (let i = 0; i < 150; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = Math.random() * 15 + 5 + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.animationDuration = Math.random() * 3 + 2 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }
            }

            async submitForm() {
                const loadingOverlay = document.getElementById('loadingOverlay');
                const nextBtn = document.getElementById('nextBtn');
                
                // Show loading
                loadingOverlay.style.display = 'flex';
                nextBtn.disabled = true;

                try {
                    // Simulate API call with a delay
                    await new Promise(resolve => setTimeout(resolve, 2500));
                    
                    // Show success step
                    this.currentStep = 6;
                    document.querySelectorAll('.step').forEach(step => {
                        step.classList.remove('active');
                    });
                    document.getElementById('successStep').classList.add('active');
                    
                    // Hide form actions
                    document.querySelector('.form-actions').style.display = 'none';
                    
                    // Hide progress bar
                    document.querySelector('.progress-container').style.display = 'none';
                    
                    // Clear saved data
                    localStorage.removeItem('microsoftJobApplicationData');
                    
                    // Create confetti effect
                    this.createConfetti();
                    
                } catch (error) {
                    alert('There was an error submitting your application. Please try again.');
                } finally {
                    loadingOverlay.style.display = 'none';
                    nextBtn.disabled = false;
                }
            }
        }

        // Initialize the form when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const form = new MultiStepForm();
            
            // Add ripple effect to buttons
            document.querySelectorAll('.btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    form.createRipple(e);
                });
            });
            
            // Initialize skills preview
            form.updateSkillsPreview();
            form.updateCharCount(document.getElementById('coverLetter'));
        });
    </script>
</body>
</html>